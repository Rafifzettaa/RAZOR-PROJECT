    <!DOCTYPE html>
    <html lang="id">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Diagnosa Gejala HIV/AIDS</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    </head>

    <body>
        <div class="container mt-5">
            <h2>Diagnosa Gejala HIV/AIDS</h2>
            <form id="diagnosisForm">
                <div class="form-group">
                    <label for="riskGroup">Kelompok Risiko:</label>
                    <select id="riskGroup" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="tinggi">Tinggi</option>
                        <option value="sedang">Sedang</option>
                        <option value="rendah">Rendah</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="weightLoss">Penurunan Berat Badan:</label>
                    <select id="weightLoss" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="fever">Demam:</label>
                    <select id="fever" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="infection">Infeksi:</label>
                    <select id="infection" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="rash">Ruam Kulit:</label>
                    <select id="rash" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="swollenLymphNodes">Kelenjar Getah Bening Membengkak:</label>
                    <select id="swollenLymphNodes" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="chronicFatigue">Kelelahan Kronis:</label>
                    <select id="chronicFatigue" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="cough">Batuk:</label>
                    <select id="cough" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="diarrhea">Diare:</label>
                    <select id="diarrhea" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="nightSweats">Keringat Malam:</label>
                    <select id="nightSweats" class="form-control" required>
                        <option value="" disabled selected>Pilih</option>
                        <option value="parah">Parah</option>
                        <option value="sedang">Sedang</option>
                        <option value="ringan">Ringan</option>
                        <option value="tidak ada">Tidak Ada</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Diagnosa</button>
            </form>

            <div id="result" class="alert d-none mt-3"></div>
        </div>




        <script>
            const form = document.getElementById("diagnosisForm");
            const resultDiv = document.getElementById("result");

            const rules = [
                {
                    conditions: {
                        riskGroup: "rendah",
                        weightLoss: "parah",
                        fever: "parah",
                        infection: "parah",
                        rash: "parah",
                        swollenLymphNodes: "parah",
                        chronicFatigue: "parah",
                        cough: "parah",
                        diarrhea: "parah",
                        nightSweats: "parah",
                    },
                    conclusion: "Anda terindikasi berada pada tahap <strong>AIDS (Stadium 4)</strong>. Segera periksakan ke dokter.",
                },
                {
                    conditions: {
                        riskGroup: "rendah",
                        weightLoss: "parah",
                        fever: "parah",
                        infection: "sedang",
                        rash: "sedang",
                        swollenLymphNodes: "sedang",
                        chronicFatigue: "parah",
                        cough: "sedang",
                        diarrhea: "sedang",
                        nightSweats: "sedang",
                    },
                    conclusion: "Anda terindikasi berada pada tahap <strong>HIV Stadium 3</strong>. Segera konsultasi dengan dokter.",
                },
                {
                    conditions: {
                        riskGroup: "rendah",
                        weightLoss: "parah",
                        fever: "sedang",
                        infection: "sedang",
                        rash: "sedang",
                        swollenLymphNodes: "sedang",
                        chronicFatigue: "parah",
                        cough: "sedang",
                        diarrhea: "sedang",
                        nightSweats: "sedang",
                    },
                    conclusion: "Anda terindikasi berada pada tahap <strong>HIV Stadium 2</strong>. Segera lakukan konsultasi ke dokter.",
                },
                {
                    conditions: {
                        riskGroup: "rendah",
                        weightLoss: "sedang",
                        fever: "sedang",
                        infection: "sedang",
                        rash: "sedang",
                        swollenLymphNodes: "sedang",
                        chronicFatigue: "sedang",
                        cough: "tidak ada",
                        diarrhea: "tidak ada",
                        nightSweats: "tidak ada",
                    },
                    conclusion: "Anda terindikasi berada pada tahap <strong>HIV Stadium 1</strong>.",
                },
                {
                    conditions: {
                        riskGroup: "tidak ada",
                        weightLoss: "tidak ada",
                        fever: "tidak ada",
                        infection: "tidak ada",
                        rash: "tidak ada",
                        swollenLymphNodes: "tidak ada",
                        chronicFatigue: "tidak ada",
                        cough: "tidak ada",
                        diarrhea: "tidak ada",
                        nightSweats: "tidak ada",
                    },
                    conclusion: "Anda tidak menunjukkan gejala HIV apapun.",
                },
            ];

            const labels = {
                riskGroup: "Kelompok Risiko",
                weightLoss: "Penurunan Berat Badan",
                fever: "Demam",
                infection: "Infeksi",
                rash: "Ruam Kulit",
                swollenLymphNodes: "Kelenjar Getah Bening Membengkak",
                chronicFatigue: "Kelelahan Kronis",
                cough: "Batuk",
                diarrhea: "Diare",
                nightSweats: "Keringat Malam"
            };

            function diagnose(conditions) {
                let bestMatch = null;
                let bestMatchPercentage = 0;
                let missingSymptoms = [];
                let nextStageSymptoms = [];

                for (let i = 0; i < rules.length; i++) {
                    let rule = rules[i];
                    let matchCount = 0;
                    let totalConditions = Object.keys(rule.conditions).length;

                    for (let key in rule.conditions) {
                        if (rule.conditions[key] === conditions[key]) {
                            matchCount++;
                        }
                    }

                    const matchPercentage = (matchCount / totalConditions) * 100;

                    if (matchPercentage > bestMatchPercentage) {
                        bestMatch = rule.conclusion;
                        bestMatchPercentage = matchPercentage;

                        // Reset gejala yang hilang
                        missingSymptoms = [];
                        for (let key in rule.conditions) {
                            if (conditions[key] !== rule.conditions[key]) {
                                missingSymptoms.push(`${labels[key]} (${rule.conditions[key]})`);
                            }
                        }

                        // Check if there is a next stage
                        if (i > 0) {
                            let nextStage = rules[i - 1];
                            nextStageSymptoms = [];
                            for (let key in nextStage.conditions) {
                                if (nextStage.conditions[key] !== conditions[key]) {
                                    nextStageSymptoms.push(`${labels[key]} (${nextStage.conditions[key]})`);
                                }
                            }
                        }
                    }
                }

                if (bestMatch) {
                    let conclusion = `${bestMatch}`;

                    if (bestMatchPercentage < 100) {
                        conclusion += `<br/>Persentase Kecocokan: ${bestMatchPercentage.toFixed(2)}%.<br/>Gejala yang hilang: ${missingSymptoms.join(', ')}`;
                    }

                    if (nextStageSymptoms.length > 0) {
                        conclusion += `<br/>Gejala yang bisa membawa Anda pada tahap berikutnya: ${nextStageSymptoms.join(', ')}`;
                    }

                    return conclusion;
                }

                return "Diagnosis tidak dapat dilakukan.";
            }

            form.addEventListener("submit", function (event) {
                event.preventDefault();

                const conditions = {
                    riskGroup: document.getElementById("riskGroup").value,
                    weightLoss: document.getElementById("weightLoss").value,
                    fever: document.getElementById("fever").value,
                    infection: document.getElementById("infection").value,
                    rash: document.getElementById("rash").value,
                    swollenLymphNodes: document.getElementById("swollenLymphNodes").value,
                    chronicFatigue: document.getElementById("chronicFatigue").value,
                    cough: document.getElementById("cough").value,
                    diarrhea: document.getElementById("diarrhea").value,
                    nightSweats: document.getElementById("nightSweats").value,
                };

                const result = diagnose(conditions);

                if (result === "Diagnosis tidak dapat dilakukan.") {
                    resultDiv.classList.remove("alert-info");
                    resultDiv.classList.add("alert-danger");
                } else {
                    resultDiv.classList.remove("alert-danger");
                    resultDiv.classList.add("alert-info");
                }

                resultDiv.innerHTML = result;
                resultDiv.classList.remove("d-none");
            });
        </script>
    </body>

    </html>
